{% extends 'index.html' %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/blog.css') }}">
{% endblock %}

{% block content %}
<section class="blog-form-page">
    <div class="blog-form-card">
        <h2>Edit Article</h2>

        <form method="POST" enctype="multipart/form-data" novalidate>
            {{ form.hidden_tag() }}

            <div class="form-group">
                {{ form.title.label }}
                {{ form.title(class="input") }}
            </div>

            <div class="form-group">
                {{ form.content.label }}
                {{ form.content(id="editor") }}
            </div>

            <div class="form-group">
                <label for="image">Image</label>
                <input type="file" id="image" name="image">
                {% if post.image %}
                    <p>Current image: 
                        <img src="{{ url_for('static', filename='uploads/blog/' ~ post.image) }}" height="80" alt="image blog">
                    </p>
                {% endif %}
            </div>

            <div class="blog-edit-actions">
                {{ form.submit(class="btn") }}
                <a href="{{ url_for('blog.blog') }}" class="btn btn-danger">Back</a>
            </div>
        </form>
    </div>
</section>

<script src="https://cdn.ckeditor.com/ckeditor5/38.0.1/classic/ckeditor.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    let editorInstance;
    ClassicEditor
        .create(document.querySelector('#editor'))
        .then(editor => { editorInstance = editor; })
        .catch(error => console.error(error));

    const form = document.querySelector('form');
    form.addEventListener('submit', function () {
        document.querySelector('#editor').value = editorInstance.getData();
    });
});
</script>
{% endblock %}
